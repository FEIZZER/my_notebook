### SHA算法

##### sha算法 概要

SHA (Security Hash Algorithm) 是美国的 NIST 和 NSA 设计的一种标准的 Hash 算法，SHA 用于数字签名的标准算法的 DSS 中，也是安全性很高的一种 Hash 算法。 sha算法具体实现有如下几种：

- **SHA-1**  SHA-1 算法的输入消息长度小于 $2^{64}$bit，最终输出的结果值是 160 Bits。 是第一代 SHA 算法标准，后来的 SHA-224、SHA-256、SHA-384 和 SHA-512 被统称为 SHA-2。
- **SHA-256**  可以生成长度256bit的信息摘要。
- **SHA-224**：SHA-256的“阉割版”，可以生成长度224bit的信息摘要。
- **SHA-512**：可以生成长度512bit的信息摘要。
- **SHA-384**：SHA-512的“阉割版”，可以生成长度384bit的信息摘要。

显然，信息摘要越长，发生碰撞的几率就越低，破解的难度就越大。但同时，耗费的性能和占用的空间也就越高。

SSL行业选择SHA作为数字签名的散列算法，从2011到2015，一直以SHA-1位主导算法。但随着互联网技术的提升，SHA-1的缺点越来越突显。目前SHA-2已经成为新的标准，所以现在签发的SSL证书，必须使用SHA-2算法签名。也许有人偶尔会看到SHA-2 384位的证书，很少会看到224位，因为224位不允许用于公共信任的证书，512位，不被软件支持。



### SHA算法 计算步骤



#### SHA-1计算实现

##### 信息预处理 step1 附加填充位

在报文末尾进行填充，使报文长度在对512取模以后的余数是448

填充是这样进行的：先补第一个比特为1，然后都补0，直到长度满足对512取模后余数是448。

需要注意的是，==信息必须进行填充==，也就是说，即使长度已经满足对512取模后余数是448，补位也必须要进行，这时要填充512个比特。

因此，填充是至少补一位，最多补512位。



##### 信息预处理 step2 附加长度值

附加长度值就是将原始数据（第一步填充前的消息）的长度信息补到已经进行了填充操作的消息后面。 该部分用64位的长度来表示， 这样刚好就使得与处理完的信息长度为 512的整数倍。 ==当然这也表示SHA-1算法只能处理长度小于 $2^{64}$ 位的信息。==



##### 常量和函数定义

- SHA-1运算最后会得到一个160位的摘要信息， 这160位信息存放在5个32位的链式变量中， 这五个变量的初始化如下(16进制)

  ```
  H0=0x67452301
  H1=0xEFCDAB89
  H2=0x98BADCFE
  H3=0x10325476
  H4=0xC3D2E1F0
  ```

- **循环左移n位**   

  

