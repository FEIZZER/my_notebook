##### http请求

> http协议是请求/响应范式的: 每个http 响应都对应一个 http 请求，http协议是无状态的，多个http请求之间是没有关系的；
> http协议的被动性：在标准的HTTP请求响应语义中，浏览器发起请求，服务器发送一个响应，这意味着在浏览器发起新请求前，服务器不能发送新信息给客户端浏览器；
>
> HTTP是请求/响应模式的，发送请求到服务端只要服务端给了响应，本次HTTP连接就结束了，或者更准确的说，是本次HTTP请求就结束了，根本没有长连接这一说。那么自然也就没有短连接这一说了。



##### http的长连接本质为tcp的长链接

TCP是一个双向的通道， 他是可以保持一段事件不关闭的。 http协议正是基于tcp/ip协议的， 创建一个http连接必须要线创建一个tcp连接， 每次创建tcp连接都需要经过三次握手。 因此最好可以维持一个长连接*（持久连接）*， 可以用这个长连接来发多个http请求。 

- http1.0 中需要在request头中加上 `Connection: keep-alive`;  支持GET POST HEAD请求
- http1.1 默认支持长链接*(除非手动在请求头加上 Connection:close)*;  支持PUT DELETE PATCH请求。
- http2.0 多路复用、服务器主动推送解析基于二进制，报头压缩

**短链接**则是浏览器与服务器只保持短暂的连接，浏览器的每次请求都需要与服务器建立一个TCP连接，服务器完成请求处理后立即断开TCP连接，服务器不跟踪每个客户也不记录过去的请求。



#### 长轮询于短轮询

由于http服务端的被动性， 服务端的数据更新时客户端不能立刻得知。 为了能够保证客户端得到最新的数据， 客户端一直不断重复的去请求服务端，这个过程就是**轮询**， **轮询表示客户端每经过固定的时间间隔就向服务器请求数据。**

##### 长轮询

http 长轮询是server 收到请求后如果有数据（是否有数据服务器说了算），就立刻响应请求；如果没有数据就会就停留一段时间，这段时间内，如果 server 请求的数据到达（有满足要求的数据了），就会立刻响应；如果这段时间过后（即等到超时为止），还没有数据，则以空数据的形式响应http请求；若浏览器收到的数据为空，会再次（立马就发）发送同样的http请求到server。
特点是：**长轮询必须使用长连接、长轮询是一种服务器推数据的技术**长轮询 的缺点：server 没有数据到达时，http连接会停留一段时间，这会造成服务器资源浪费；

##### 短轮询

http 短轮询是 server 收到请求 不管是否有数据到达都直接响应http 请求；如果浏览器收到的数据为空，则隔一段时间（因为立刻请求的话极大可能还是返回空，所有等一会），浏览器又会发送相同的http请求到server 以获取数据响应；
短轮询一个明显的缺点就是： 客户端定时发起请求，如果服务端数据长期没有变化，会产生大量无效的请求，浪费网络资源。

##### 长短轮询和长短连接的却别

1. 决定的方式，一个TCP连接是否为长连接，是通过设置HTTP的Connection Header来决定的，而且是需要两边都设置才有效。而一种轮询方式是否为长轮询，是根据服务端的处理方式来决定的，与客户端没有关系。
2. 实现的方式，连接的长短是通过协议来规定和实现的。而轮询的长短，是服务器通过编程的方式手动挂起请求来实现的。

