### sync.atomic



#### sync.atomic包实现的原子操作 

原子操作表现为不可分割的操作， 要么执行要么不执行， 外界是看不到原子操作的之间状态的。

##### 原子操作与互斥操作的区别

- 底层实现不同

  -  atomic中原子操作是由底层硬件指令直接提供的； 指令在执行的过程中是不允许中断的，因此原子操作可以在`lock-free`的情况下保证并发安全，并且它的性能也能做到随`CPU`个数的增多而线性扩展。

  -  Mutex由操作系统的调度器实现。

- 目的不同。 Mutex用于保护一段逻辑操作， atomic用于保护对变量的更新。



`atomic.AddXXXType()` 函数实现了对操作数的原子增减， （`XXType`包括：`int32`、`int64`、`uint32`、`uint64`、`uintptr`）





载入操作（LoadXXType）：保证读取到操作数前，没有其他routine对其进行更改操作；
存储操作（StoreXXType）：保证存储时的原子性（避免被其他线程读取到修改一半的数据）；
比较并交互操作（CompareAndSwapXXType）：保证交换的CAS，只有原有值没被更改时才会交换；
交换操作（SwapXXType）：直接交换，不关心原有值。
